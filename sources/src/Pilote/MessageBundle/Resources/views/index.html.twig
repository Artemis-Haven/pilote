{% extends 'PiloteMessageBundle::layout.html.twig' %}

{% block message_title %}
    Messagerie
{% endblock %}

{% block message_content %}
<div class="sheet">
    <div id="messagesList">
        {% for metadata in app.user.metadata if not metadata.read %}
            <a class="msgPreview" href="{{path('pilote_message_thread', {'id': metadata.thread.id})}}">
            	<span class="msgPreviewTitle">
	            	{% if metadata.thread.type == boardThread %}
	            		Projet : {{metadata.thread.title}}
	            	{% elseif metadata.thread.type == adminThread %}
                        {% if is_granted('ROLE_ADMIN') %}
                            Demande d'aide aux administrateurs : {{ metadata.thread.creator }}
                        {% else %}
                            Discussion avec les administrateurs
                        {% endif %}
	            	{% else %}
	            		{{ metadata.thread.participants|join(', ') }}
	            	{% endif %}
            	</span>
            	<span class="msgPreviewContent">
            		{{metadata.thread.messages | last | truncate(200) }}
            	</span>
            </a>
        {% else %}
            <div class="emptyList">Aucun message non lu. <br><br>SÃ©lectionnez une conversation dans la colonne de droite.</div>
        {% endfor %}
    </div>
</div>

{% endblock %}
